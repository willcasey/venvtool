#/bin/bash

#GLOBAL VARS
GLOBAL_ENV_DIR=$HOME/.envs

#FUNCTIONS
function printhelp {
	printf """
Usage: vnv <command> argument

General Commands:
-c <virtual_env>, --create <virtual_env>		Creates a virtual environment. 
-a <virtual_env>, --activate <virtual_env>		Activates a virtual environment. 
-rm <virtual_env>, --remove <virtual_env>		Removes a virtual environment from the directory.
-ls 							List all available virtual environments.
-d, --deactivate					Deactivates the current virtual environment.
-h, --help						Shows help for commands.
"""

}
function activate {
	ENV_PATH=$GLOBAL_ENV_DIR/$1
	if [ -z $ENV_PATH ]; then
		echo "Please provide the name of the virtual environment you want to activate"
	elif [ -e "$ENV_PATH" ]; then
		source $ENV_PATH/bin/activate 
	else
		echo "$1 is not a valid virtual environment"
	fi
}

function make {
	if [ -z $1 ]; then
		echo "Please add a name for your virtual environment"
	else
        	virtualenv $HOME/.envs/$1
	fi
}

function remove {
	ENV_PATH=$GLOBAL_ENV_DIR/$1
	if [ -z $1 ]; then
		echo "add a name for your virtual environment"
	elif [ -e "$ENV_PATH" ]; then
        	rm -r $ENV_PATH
		echo "removed $1 from virtual environments"
	else
		echo "$1 is not a valid virtual environment"
	fi
}


for arg in "$@"
do
    case $arg in
	-h|--help)
	printhelp
	shift
        ;;
        -ls)
	ls $GLOBAL_ENV_DIR
        shift        
	;;
        -c=*|--create=*)
	NAME=${arg#*=}
	make $NAME
        shift
        ;;
        -c|--create)
	NAME=$2
	make $NAME
        shift
        ;;
        -rm=*|--remove=*)
	NAME=${arg#*=}
	remove $NAME
        shift
        ;;
        -rm|--remove)
	NAME=$2
	remove $NAME
        shift
        ;;
        -a=*|--activate=*)
	VIRTUAL_ENV=${arg#*=}
        activate $VIRTUAL_ENV	
        shift
        ;;
        -a|--activate)
	VIRTUAL_ENV=$2
        activate $VIRTUAL_ENV	
        shift
        ;;
        -d|--deactivate)
        deactivate	
        shift
        ;;
    esac
done
